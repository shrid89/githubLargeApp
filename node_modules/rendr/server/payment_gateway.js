var Authorizenet = require('paynode').use('authorizenet');

function AuthDotNet(options) {}

AuthDotNet.prototype.makePayment = function(req, callback) {
    var client = Authorizenet.createClient({
        level: Authorizenet.levels.sandbox,
        login: '5MC9Lgk9zT3',
        tran_key: '9SC2j8B2X4635bbT'
    })

    client.performAimTransaction({
        "x_type": "AUTH_CAPTURE", //AUTH_ONLY
        "x_method": "CC",
        "x_card_num": req.query.CreditCard,
        "x_exp_date": req.query.ExpDate,
        "x_amount": req.query.Amount,
        "x_description": req.query.Description,
        "x_first_name": req.query.FirstName,
        "x_last_name": req.query.LastName,
        "x_address": req.query.Address,
        "x_state": req.query.State,
        "x_zip": req.query.Zip
    })
            .on('success', function(err, result) {     
                callback(result);
            })
            .on('failure', function(err, result) {         
                callback(result);
            });
};

module.exports = AuthDotNet;